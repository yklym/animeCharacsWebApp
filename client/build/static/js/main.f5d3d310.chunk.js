(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{35:function(e,t,a){e.exports=a(66)},40:function(e,t,a){},41:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(32),c=a.n(r),s=(a(40),a(41),a(16)),o=a(2),i=a(3),m=a(5),u=a(4),h=a(6),d=a(9),p=a(1),g=a(15),E=a.n(g);function b(){return localStorage.token?fetch("/api/v1/auth/checkToken",{method:"get",headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){return e.json()})).then((function(e){return e.token?(localStorage.setItem("token",e.token),E()(localStorage.token)):(localStorage.removeItem("token"),{role:null,_id:null,username:null})})):(console.log("Storage empty"),Promise.reject({role:null,_id:null,username:null}))}function f(){return localStorage.token?(console.log("Decode:"),console.log(E()(localStorage.token)),E()(localStorage.token)):{}}var v=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){b().then((function(e){a.setState({userRole:e.role,username:e.username,userId:e._id})}))},a.state={userRole:null,username:null,userId:null},a.cancel="",a.logOutHandle=a.logOutHandle.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"logOutHandle",value:function(e){e.preventDefault(),localStorage.removeItem("token");var t=b();this.setState({userRole:t.role,username:t.username,userId:t._id})}},{key:"render",value:function(){return 1===this.state.userRole?l.a.createElement("div",{className:"myNav"},l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/"},"Home"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/about"},"About"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/users"},"Users"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/characters"},"Characters"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/titles"},"Titles"),l.a.createElement(p.c,{exact:!0,className:"navlink login",to:"/",onClick:this.logOutHandle},"Log Out"),l.a.createElement(p.c,{exact:!0,className:"navlink login",to:"/users/".concat(this.state.userId)},this.state.username)):0===this.state.userRole?l.a.createElement("div",{className:"myNav"},l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/"},"Home"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/about"},"About"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/titles"},"Titles"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/characters"},"Characters"),l.a.createElement(p.c,{exact:!0,className:"navlink login",to:"/",onClick:this.logOutHandle},"Log Out"),l.a.createElement(p.c,{exact:!0,className:"navlink login",to:"/users/".concat(this.state.userId)},this.state.username)):l.a.createElement("div",{className:"myNav"},l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/"},"Home"),l.a.createElement(p.c,{exact:!0,className:"navlink",activeClassName:"navlink-active",to:"/about"},"About"),l.a.createElement(p.c,{exact:!0,className:"navlink login",activeClassName:"navlink-active",to:"/auth/login"},"Log in"),l.a.createElement(p.c,{exact:!0,className:"navlink login",activeClassName:"navlink-active",to:"/auth/register"},"Sign up"))}}]),t}(n.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log("rendering index page"),l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!"),l.a.createElement("p",null,"This is my first web-page!")))}}]),t}(n.Component);var C=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!"),l.a.createElement("p",null,"Some About Here!")))}}]),t}(n.Component),y=a(10),S=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"alert alert-danger"},l.a.createElement("strong",null,l.a.createElement("h3",null,"Wrong inputs!"),l.a.createElement("ul",null,this.props.loginErr?l.a.createElement("li",null,"Login is not unique"):l.a.createElement(l.a.Fragment,null),this.props.passErr?l.a.createElement("li",null,"Passwords are different"):l.a.createElement(l.a.Fragment,null))))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){if(e.preventDefault(),a.state.password1!==a.state.password2)return console.log("Diff passwords"),void a.setState({passErr:!0});console.log("HANDLE FORM SUBMIT");var t=a.state;return fetch("/api/v1/auth/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(console.log(e),400===e.status)throw a.setState({loginErr:!0}),console.log("Diff logins"),new Error("login is not unique");a.setState({redirect:!0})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){var t;a.setState((t={},Object(y.a)(t,e.target.name,e.target.value),Object(y.a)(t,"loginErr",!1),Object(y.a)(t,"passErr",!1),t))},a.state={login:"",fullname:"",password1:"",password2:"",redirect:!1,loginErr:!1,passErr:!1},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.redirect?(console.log("REGISTER PAGE REDIRECT IS TRUE"),l.a.createElement(s.a,{to:"/"})):l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",{className:"loginFormMain"},l.a.createElement("form",{className:"register"},l.a.createElement("div",{className:"container"},l.a.createElement("h1",null,"Register"),l.a.createElement("p",null,"Please fill in this form to create an account."),l.a.createElement("hr",null),l.a.createElement("label",null,l.a.createElement("b",null,"Login"),l.a.createElement("input",{type:"text",placeholder:"Enter Login",maxLength:"20",name:"login",value:this.state.login,onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})),l.a.createElement("label",null,l.a.createElement("b",null,"Fullname"),l.a.createElement("input",{type:"text",placeholder:"Enter Fullname",maxLength:"20",name:"fullname",value:this.state.fullname,onChange:this.handleChange,required:!0,pattern:"^(\\w\\w+)\\s(\\w+)$"})),l.a.createElement("label",null,l.a.createElement("b",null,"Password"),l.a.createElement("input",{type:"password",placeholder:"Enter Password",maxLength:"20",name:"password1",value:this.state.password1,onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})),l.a.createElement("label",null,l.a.createElement("b",null,"Password"),l.a.createElement("input",{type:"password",placeholder:"Enter Password",maxLength:"20",name:"password2",value:this.state.password2,onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})),l.a.createElement("hr",null),this.state.loginErr||this.state.passErr?l.a.createElement(S,{loginErr:this.state.loginErr,passErr:this.state.passErr}):l.a.createElement(l.a.Fragment,null),l.a.createElement("hr",null),l.a.createElement("p",null,"By creating an account you agree to our ",l.a.createElement("a",{href:"#"},"Terms & Privacy"),"."),l.a.createElement("button",{type:"submit",className:"registerbtn",onClick:this.handleSubmit},"Register")),l.a.createElement("div",{className:"container signin"},l.a.createElement("p",null,"Already have an account? ",l.a.createElement(p.b,{to:"/auth/login"},"Sign in"),".")))))}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),console.log("HANDLE FORM SUBMIT");var t={username:a.state.username,password:a.state.password};return fetch("/api/v1/auth/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("DATA:"),console.log(e.response.token),e.message||(localStorage.setItem("token",e.response.token),a.setState({redirect:!0}))})).catch((function(e){console.log(e)}))},a.handleChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.state={username:"",password:"",redirect:!1},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log("RENDERING LOGIN PAGE"),this.state.redirect?(console.log("LOGIN PAGE REDIRECT IS TRUE"),l.a.createElement(s.a,{to:"/"})):l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",{className:"loginFormMain"},l.a.createElement("form",{className:"register",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"container"},l.a.createElement("h1",null,"Login"),l.a.createElement("p",null,"Please fill in this form to login."),l.a.createElement("hr",null),l.a.createElement("label",{for:"email"},l.a.createElement("b",null,"login")),l.a.createElement("input",{type:"text",placeholder:"Enter login",name:"username",maxlength:"10",required:!0,value:this.state.username,onChange:this.handleChange}),l.a.createElement("label",{for:"psw"},l.a.createElement("b",null,"Password")),l.a.createElement("input",{type:"password",placeholder:"Enter Password",maxlength:"15",name:"password",value:this.state.password,onChange:this.handleChange,required:!0}),l.a.createElement("button",{type:"submit",className:"registerbtn"},"Login")))))}}]),t}(n.Component),O=a(7),j=a.n(O),A=function(e){var t=e.showPrevLink,a=e.showNextLink,n=e.pagesCount,r=e.handlePrevClick,c=e.handleNextClick,s=e.loading,o=e.currPage;return n?l.a.createElement("ul",{className:"pagination pg-amber justify-content-center",id:"characsPagUl"},l.a.createElement("li",{className:"page-item"},l.a.createElement("a",{className:"nav-link ".concat(t?"":"disabled").concat(s?"greyed-out":""),onClick:r,"aria-label":"Previous"},l.a.createElement("span",{"aria-hidden":"true"},"\xab"),l.a.createElement("span",{className:"sr-only"},"Previous"))),l.a.createElement("li",{className:"page-item  disabled active characPag"},l.a.createElement("a",{className:"page-link"},o,"/",n)),l.a.createElement("li",{className:"page-item"},l.a.createElement("a",{className:"nav-link".concat(a?"":" disabled").concat(s?"greyed-out":""),onClick:c,"aria-label":"Next"},l.a.createElement("span",{"aria-hidden":"true"},"\xbb"),l.a.createElement("span",{className:"sr-only"},"Next")))):(console.log("results"),l.a.createElement("div",null))},R=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("tr",null,l.a.createElement(p.b,{to:"/users/".concat(this.props.user._id)},l.a.createElement("td",null,this.props.user.login)),l.a.createElement("td",null,this.props.user.fullname),l.a.createElement("td",null,new Date(this.props.user.registeredAt).toDateString()))}}]),t}(n.Component),I=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).getPagesCount=function(e,t){var a=e%t===0?0:1;return Math.floor(e/t)+a},a.handlePageClick=function(e){var t="prev"===e?a.state.currentPageNo-1:a.state.currentPageNo+1;a.state.loading||a.setState({loading:!0,message:""},(function(){a.fetchSearchResults(t,a.state.query)}))},a.renderSearchResults=function(){console.log(a.state.results);var e=a.state,t=e.results,n=e.query;if(console.log(t),t&&Object.keys(t).length&&t.length){var r=t.map((function(e){return l.a.createElement(R,{user:e})}));return l.a.createElement("tbody",null,r)}return l.a.createElement("div",{className:"alert alert-warning"},l.a.createElement("h2",null,"  No results for ",l.a.createElement("strong",null," ",n)))},a.handleOnInputChange=function(e){var t=e.target.value;t?a.setState({query:t,loading:!0,message:""},(function(){a.fetchSearchResults(1,t)})):(a.setState({query:t,results:{},totalResults:0,totalPages:0,currentPageNo:0,message:""}),a.fetchSearchResults(1,t))},a.fetchSearchResults=function(e,t){var n="/api/v1/users?page=".concat(e=e||1).concat(t?"&search=".concat(t):"");a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(n,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){console.log(t);var n=t.data.resUsers.length?"":"There are no more search results. Please try a new search.";a.setState({currentPageNo:e,results:t.data.resUsers,pagesCount:t.data.pagesAmount,message:n,loading:!1})})).catch((function(e){(j.a.isCancel(e)||e)&&a.setState({loading:!1,message:"Failed to fetch results.Please check network"})}))};var n=f();return a.state={query:"",results:{},error:"",message:"",loading:!1,totalResults:0,pagesCount:0,currentPageNo:0,userRole:n.role,username:n.username},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSearchResults(1,"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.query,n=t.loading,r=t.currentPageNo,c=t.pagesCount,o=t.userRole,i=1<r,m=c>r;return 1!==o&&0!==o?l.a.createElement(s.a,{to:"/auth/login"}):l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("input",{type:"text",name:"search",value:a,id:"characSearch",className:"entitySearch",placeholder:"Search..",onChange:this.handleOnInputChange}),l.a.createElement("div",{class:"table"},l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",{class:"table-head"},l.a.createElement("th",null,"Login"),l.a.createElement("th",null,"Fullname"),l.a.createElement("th",null,"Registred"))),this.renderSearchResults())),l.a.createElement(A,{loading:n,showPrevLink:i,showNextLink:m,currPage:r,pagesCount:c,handlePrevClick:function(){return e.handlePageClick("prev")},handleNextClick:function(){return e.handlePageClick("next")}}),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin abilities:"),l.a.createElement("button",{type:"button",className:"btn btn-info"},"Some admin Feature"),l.a.createElement("button",{type:"button",className:"btn btn-warning"},"Another admin Feature")):l.a.createElement(l.a.Fragment,null)))}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).deleteClickHandler=function(e){a.fetchSearchResults()},a.fetchSearchResults=function(){var e=a.props.targetApiUrl;a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),fetch(e,{method:"delete",headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){a.setState({redirect:!0})}))},a.state={redirect:!1},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.redirect?l.a.createElement(s.a,{to:this.props.returnLink}):l.a.createElement("div",{className:"modal fade",id:"exampleModalCenter",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Confirm action"),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body"},"Are you sure to delete ",this.props.entityName,"?"),l.a.createElement("div",{className:"modal-footer"},l.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),l.a.createElement("div",null,l.a.createElement("input",{type:"button",name:"delete Char","data-dismiss":"modal",className:"btn btn-danger",value:"Delete Char",onClick:this.deleteClickHandler}))))))}}]),t}(n.Component),T=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){a.fetchSearchResults()},a.fetchSearchResults=function(){var e="/api/v1/users/".concat(a.state.pageUserId);a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(e,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){a.setState({user:e.data})}))};var n=a.props.location.pathname.split("/"),l=n[n.length-1],r=f();return a.state={pageUserId:l,userRole:r.role,userId:r._id,username:r.username},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(!this.state.userId)return l.a.createElement(s.a,{to:"/"});if(!this.state.user)return l.a.createElement("div",null,l.a.createElement("h1",null,"ERROR"));var e=this.state.user;return l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("div",{className:"entitiy-page-wrapper"},l.a.createElement("div",{className:"entity-page-image"},l.a.createElement("img",{src:e.image,alt:""})),l.a.createElement("div",{className:"entity-page-info"},l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Fullname:"),l.a.createElement("td",null,e.fullname)),l.a.createElement("tr",null,l.a.createElement("td",null,"Login:"),l.a.createElement("td",null,e.login)),l.a.createElement("tr",null,l.a.createElement("td",null,"Registration date:"),l.a.createElement("td",null,new Date(e.registeredAt).toDateString()))))),l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"User role:"),l.a.createElement("td",null,e.role?"Admin":"User")),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---")),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---"))))))),this.state.pageUserId===e._id?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Config:"),l.a.createElement(p.b,{className:"btn btn-warning",to:"/updateUser/".concat(e._id)},"Update info")):l.a.createElement(l.a.Fragment,null),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin features:"),l.a.createElement("button",{type:"button",className:"btn btn-danger","data-toggle":"modal","data-target":"#exampleModalCenter"},"Delete charac"),0===e.role?l.a.createElement("button",{type:"button",class:"btn btn-primary"},"Make Admin"):l.a.createElement("button",{type:"button",class:"btn btn-primary"},"Make User"),l.a.createElement(p.b,{className:"btn btn-warning",to:"/updateUser/".concat(e._id)},"Update info")):l.a.createElement(l.a.Fragment,null)))}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t={password:a.state.targetUser.password,registeredAt:a.state.targetUser.registeredAt,fullname:a.state.fullname,login:a.state.login,tgLogin:a.state.tgLogin,chatId:a.state.chatId,image:a.state.image,imageUrl:a.state.imageUrl,subscribes:a.state.subscribes},n=new FormData;for(var l in t)n.append(l,t[l]);return fetch("/api/v1/users/".concat(a.state.targetUser._id),{method:"put",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:n}).then((function(e){return e.json()})).then((function(e){a.setState({redirect:e._id})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleFileInput=function(e){var t=Array.from(e.target.files);a.setState({image:t[0],imageUrl:URL.createObjectURL(t[0])})},a.cancelUpdateHandler=function(){a.setState({redirect:"".concat(a.state.characId)})},a.fileInput=l.a.createRef(),a.state={login:"",fullname:"",image:void 0},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.pathname.split("/"),a=t[t.length-1],n="/api/v1/users/".concat(a);fetch(n,{method:"get",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return e.json()})).then((function(t){e.setState({targetUser:t,tgLogin:t.tgLogin,login:t.login,fullname:t.fullname,imageUrl:t.image,chatId:t.chatId,subscribes:t.subscribes})})).catch((function(e){}))}},{key:"render",value:function(){return this.state.redirect?l.a.createElement(s.a,{to:"/users/".concat(this.state.redirect)}):l.a.createElement("div",null," ",l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("form",{className:"new-charac-form",encType:"multipart/form-data",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"new-charac-input-div"},l.a.createElement("div",{className:"form-group-big"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Fullname:",l.a.createElement("input",{type:"text",className:"form-control",value:this.state.fullname,name:"fullname",onChange:this.handleChange,required:!0,pattern:"^(\\w\\w+)\\s(\\w+)$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Login:",l.a.createElement("input",{type:"text",className:"form-control",value:this.state.login,name:"login",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Telegramm Login:",l.a.createElement("input",{type:"text",className:"form-control",value:this.state.tgLogin,name:"tgLogin",onChange:this.handleChange,required:!0,pattern:"^(?=.{1,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})))),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Photo"),l.a.createElement("button",{type:"button",className:"btn btn-info"},l.a.createElement("label",{htmlFor:"createCharacImageInput"},"Choose a file")),l.a.createElement("div",null,l.a.createElement("img",{className:"formPreviewImage",src:this.state.imageUrl,alt:""})),l.a.createElement("input",{type:"file",name:"userImage",id:"createCharacImageInput",ref:this.fileInput,onChange:this.handleFileInput,className:"image-inputfile"}))),l.a.createElement("br",null),l.a.createElement("hr",null),l.a.createElement("input",{type:"submit",className:"btn btn-warning",value:"Update User"}),l.a.createElement("input",{type:"submit",className:"btn btn-secondary",value:"Cancel",onClick:this.cancelUpdateHandler}))))}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),console.log("HANDLE FORM SUBMIT");var t={name:a.state.name,fullname:a.state.fullname,description:a.state.characDescr,age:a.state.age,alias:a.state.alias,characPic:a.state.image};console.log(t);var n=new FormData;for(var l in t)n.append(l,t[l]);return fetch("/api/v1/characters",{method:"post",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:n}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("DATA:"),console.log(e),a.setState({redirect:e._id})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),console.log("Handling input"),console.log(a.state)},a.handleFileInput=function(e){var t=Array.from(e.target.files);console.log(),a.setState({image:t[0],imageUrl:URL.createObjectURL(t[0])})},a.fileInput=l.a.createRef(),a.state={name:"",fullname:"",characDescr:"Character description......",age:-1,alias:"",image:void 0,imageUrl:""},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log("RENDERING New CHarac PAGE"),this.state.redirect?(console.log("LOGIN PAGE REDIRECT IS TRUE"),l.a.createElement(s.a,{to:"/characters/".concat(this.state.redirect)})):l.a.createElement("div",null," ",l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("form",{className:"new-charac-form",encType:"multipart/form-data",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"new-charac-input-div"},l.a.createElement("div",{className:"form-group-big"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Name:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter name",name:"name",onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Full Name:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter Fullname",name:"fullname",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Age:",l.a.createElement("input",{type:"number",min:"1",max:"9999999",name:"age",value:this.state.age,onChange:this.handleChange,required:!0}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Alias:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter Alias",name:"alias",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})))),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Description"),l.a.createElement("textarea",{name:"characDescr",value:this.state.characDescr,onChange:this.handleChange})),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Photo"),l.a.createElement("button",{type:"button",className:"btn btn-info"},l.a.createElement("label",{htmlFor:"createCharacImageInput"},"Choose a file")),l.a.createElement("div",null,l.a.createElement("img",{className:"formPreviewImage",src:this.state.imageUrl,alt:""})),l.a.createElement("input",{type:"file",name:"characPict",id:"createCharacImageInput",ref:this.fileInput,onChange:this.handleFileInput,className:"image-inputfile"}))),l.a.createElement("br",null),l.a.createElement("hr",null),l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Create new character"}))))}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).onFilesError=function(e,t){console.log("error code "+e.code+": "+e.message)},a.handleSubmit=function(e){e.preventDefault(),console.log("HANDLE FORM SUBMIT"),console.log(a.state);var t={name:a.state.name,fullname:a.state.fullname,characDescr:a.state.characDescr,age:a.state.age,image:a.state.image,description:a.state.characDescr,alias:a.state.alias,imageUrl:a.state.imageUrl,prevChar:a.state.character};console.log(t);var n=new FormData;for(var l in t)n.append(l,t[l]);return fetch("/api/v1/characters/".concat(a.state.characId),{method:"put",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:n}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("DATA:"),console.log(e),a.setState({redirect:e._id})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),console.log("Handling input"),console.log(a.state)},a.handleFileInput=function(e){var t=Array.from(e.target.files);a.setState({image:t[0],imageUrl:URL.createObjectURL(t[0])})},a.cancelUpdateHandler=function(){a.setState({redirect:"".concat(a.state.characId)})},a.fileInput=l.a.createRef(),a.state={name:"dddddd",fullname:"dddddd",characDescr:"Character description......",alias:"-",age:-1,image:void 0},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("");var t=this.props.location.pathname.split("/"),a=t[t.length-1],n="/api/v1/characters/".concat(a);fetch(n,{method:"get",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return e.json()})).then((function(t){console.log("update Charac fetch result:"),console.log(t),e.setState({character:t,name:t.name,fullname:t.fullname,characDescr:t.characDescr,alias:t.alias,age:t.age,imageUrl:t.image,characId:a,image:void 0})})).catch((function(e){}))}},{key:"render",value:function(){if(console.log("RENDERING New CHarac PAGE"),this.state.redirect)return console.log("LOGIN PAGE REDIRECT IS TRUE"),l.a.createElement(s.a,{to:"/characters/".concat(this.state.redirect)});var e=this.state;return l.a.createElement("div",null," ",l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("form",{className:"new-charac-form",encType:"multipart/form-data",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"new-charac-input-div"},l.a.createElement("div",{className:"form-group-big"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Name:",l.a.createElement("input",{type:"text",className:"form-control",value:e.name,name:"name",onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Full Name:",l.a.createElement("input",{type:"text",className:"form-control",value:e.fullname,name:"fullname",onChange:this.handleChange,required:!0,pattern:"^(\\w\\w+)\\s(\\w+)$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Age:",l.a.createElement("input",{type:"number",min:"1",max:"9999999",name:"age",value:e.age,onChange:this.handleChange,required:!0}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Alias:",l.a.createElement("input",{type:"text",className:"form-control",value:e.alias,name:"alias",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})))),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Description"),l.a.createElement("textarea",{name:"characDescr",value:this.state.characDescr,onChange:this.handleChange})),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Photo"),l.a.createElement("button",{type:"button",className:"btn btn-info"},l.a.createElement("label",{htmlFor:"createCharacImageInput"},"Choose a file")),l.a.createElement("div",null,l.a.createElement("img",{className:"formPreviewImage",src:this.state.imageUrl,alt:""})),l.a.createElement("input",{type:"file",name:"characPict",id:"createCharacImageInput",ref:this.fileInput,onChange:this.handleFileInput,className:"image-inputfile"}))),l.a.createElement("br",null),l.a.createElement("hr",null),l.a.createElement("input",{type:"submit",className:"btn btn-warning",value:"Update Character"}),l.a.createElement("input",{type:"submit",className:"btn btn-secondary",value:"Cancel",onClick:this.cancelUpdateHandler}))))}}]),t}(n.Component),U=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.charac.image,t=this.props.charac.name,a=this.props.charac._id;return l.a.createElement("div",{className:"card border-dark mb-3"},l.a.createElement("div",{className:"card-img-wrapper"},l.a.createElement(p.b,{to:"/characters/"+a},l.a.createElement("img",{src:"".concat(e),className:"card-img-top",alt:"..."}))),l.a.createElement("div",{className:"card-body justify-content-between"},l.a.createElement("h5",{className:"card-title"},t),l.a.createElement(p.b,{to:"/characters/"+a},l.a.createElement("button",{className:"btn btn-secondary"},"Details"))))}}]),t}(n.Component),F=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).getPagesCount=function(e,t){var a=e%t===0?0:1;return Math.floor(e/t)+a},a.handlePageClick=function(e){var t="prev"===e?a.state.currentPageNo-1:a.state.currentPageNo+1;a.state.loading||a.setState({loading:!0,message:""},(function(){a.fetchSearchResults(t,a.state.query)}))},a.renderSearchResults=function(){var e=a.state,t=e.results,n=e.query;if(t&&Object.keys(t).length&&t.length){var r=t.map((function(e){return l.a.createElement(U,{charac:e})}));return l.a.createElement("div",{className:"entities-wrapper",id:"characters-div"},r)}return l.a.createElement("div",{class:"alert alert-warning"},l.a.createElement("h2",null,"  No results for ",l.a.createElement("strong",null," ",n)))},a.handleOnInputChange=function(e){var t=e.target.value;t?a.setState({query:t,loading:!0,message:""},(function(){a.fetchSearchResults(1,t)})):(a.setState({query:t,results:{},totalResults:0,totalPages:0,currentPageNo:0,message:""}),a.fetchSearchResults(1,t))},a.fetchSearchResults=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n="/api/v1/characters?page=".concat(e=e||1).concat(t?"&search=".concat(t):"");a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(n,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){var n=t.data.resCharacs.length?"":"There are no more search results. Please try a new search.";a.setState({currentPageNo:e,results:t.data.resCharacs,pagesCount:t.data.pagesAmount,message:n,loading:!1})})).catch((function(e){(j.a.isCancel(e)||e)&&a.setState({loading:!1,message:"Failed to fetch results.Please check network"})}))};var n=-1,r="";if(localStorage.token){var c=E()(localStorage.token);n=c.role,r=c.username}else n=-1;return a.state={query:"",results:{},error:"",message:"",loading:!1,totalResults:0,pagesCount:0,currentPageNo:0,userRole:n,username:r},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSearchResults(1,"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.query,n=t.loading,r=t.currentPageNo,c=t.pagesCount,o=t.userRole,i=(t.username,1<r),m=c>r;return-1===o?l.a.createElement(s.a,{to:"/auth/login"}):l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("div",{className:"filter-box"},l.a.createElement("aside",{className:"filters"},l.a.createElement("p",null,"Some filters here"),this.props.isAdmin?l.a.createElement("form",{action:"/newCharacter",method:"GET"},l.a.createElement("input",{type:"submit",className:"btn btn-info",value:"New Title"})):l.a.createElement(l.a.Fragment,null)),l.a.createElement("aside",{className:"filters"},l.a.createElement("p",null,"And here"))),l.a.createElement("main",{className:"entities-main"},l.a.createElement("input",{type:"text",name:"search",value:a,id:"characSearch",className:"entitySearch",placeholder:"Search..",onChange:this.handleOnInputChange}),l.a.createElement("div",{className:"card-deck"},this.renderSearchResults()),l.a.createElement(A,{loading:n,showPrevLink:i,showNextLink:m,currPage:r,pagesCount:c,handlePrevClick:function(){return e.handlePageClick("prev")},handleNextClick:function(){return e.handlePageClick("next")}}),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin abilities:"),l.a.createElement(p.b,{to:"/newCharacter",className:"btn btn-success"},"Create charac"),l.a.createElement("button",{type:"button",className:"btn btn-info"},"Some admin Feature"),l.a.createElement("button",{type:"button",className:"btn btn-warning"},"Another admin Feature")):l.a.createElement(l.a.Fragment,null)))}}]),t}(n.Component),L=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).fetchSearchResults=function(){var e="/api/v1/characters/".concat(a.state.characId);a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(e,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){a.setState({character:e.data})})).catch((function(e){}))},a.handleSubscription=function(){return fetch("/api/v1/createSubscription",{method:"post",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify({characId:a.state.character._id,userId:a.state.userId})}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log(e),a.setState({character:e})}))},a.handleUnSubscription=function(){return fetch("/api/v1/deleteSubscription",{method:"post",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify({characId:a.state.character._id,userId:a.state.userId})}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log(e),a.setState({character:e})}))},a.renderTgButton=function(){return a.state.character.subscribers.includes(a.state.userId)?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"User Buttons:"),l.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:a.handleUnSubscription},"Unsubscribe")):l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"User Buttons:"),l.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:a.handleSubscription},"Subscribe"))};var n=a.props.location.pathname.split("/"),r=n[n.length-1],c=f();return a.state={userId:c._id,userRole:c.role,tgLogin:c.tgLogin,characId:r},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSearchResults()}},{key:"render",value:function(){if(!this.state.character)return l.a.createElement("div",null,l.a.createElement("h1",null,"ERROR"));var e=this.state.character;return l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("h2",null,"".concat(e.name," ").concat(e.fullname)),l.a.createElement("div",{className:"entitiy-page-wrapper"},l.a.createElement("div",{className:"entity-page-image"},l.a.createElement("img",{src:e.image,alt:""})),l.a.createElement("div",{className:"entity-page-info"},l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"name:"),l.a.createElement("td",null,e.name)),l.a.createElement("tr",null,l.a.createElement("td",null,"fullname:"),l.a.createElement("td",null,e.fullname)),l.a.createElement("tr",null,l.a.createElement("td",null,"Was added:"),l.a.createElement("td",null,new Date(e.addedAt).toDateString()))))),l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Age:"),l.a.createElement("td",null,e.age)),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---")),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---")))))),l.a.createElement("h3",null,"Character Bio"),l.a.createElement("div",{className:"entity-page-main"},e.description),l.a.createElement("h3",null,"Photo collection:"),l.a.createElement("div",{className:"entity-page-footer"},l.a.createElement("p",null,"Some other text and abilities here without border and block")),this.state.tgLogin?this.renderTgButton():l.a.createElement(l.a.Fragment,null),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin abilities:"),l.a.createElement("button",{type:"button",className:"btn btn-danger","data-toggle":"modal","data-target":"#exampleModalCenter"},"Delete charac"),l.a.createElement("button",{type:"button",className:"btn btn-warning"},l.a.createElement(p.b,{to:"/updateCharacter/".concat(e._id)},"Update charac"))):l.a.createElement(l.a.Fragment,null))),1===this.state.userRole?l.a.createElement(x,{entityName:"character ".concat(e.name),targetApiUrl:"/api/v1/characters/".concat(e._id),returnLink:"/characters"}):l.a.createElement(l.a.Fragment,null))}}]),t}(n.Component),H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),console.log("HANDLE FORM SUBMIT");var t={name:a.state.name,fullname:a.state.fullname,description:a.state.description,age:a.state.age,alias:a.state.alias,characPic:a.state.image};console.log(t);var n=new FormData;for(var l in t)n.append(l,t[l]);return fetch("/api/v1/characters",{method:"post",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:n}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("DATA:"),console.log(e),a.setState({redirect:e._id})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),console.log("Handling input"),console.log(a.state)},a.handleFileInput=function(e){var t=Array.from(e.target.files);console.log(),a.setState({image:t[0],imageUrl:URL.createObjectURL(t[0])})},a.fileInput=l.a.createRef(),a.state={name:"",fullname:"",characDescr:"Character description......",age:-1,alias:"",image:void 0,imageUrl:""},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log("RENDERING New CHarac PAGE"),this.state.redirect?(console.log("LOGIN PAGE REDIRECT IS TRUE"),l.a.createElement(s.a,{to:"/characters/".concat(this.state.redirect)})):l.a.createElement("div",null," ",l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("form",{className:"new-charac-form",encType:"multipart/form-data",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"new-charac-input-div"},l.a.createElement("div",{className:"form-group-big"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Name:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter name",name:"name",onChange:this.handleChange,required:!0,pattern:"^(?=.{4,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Full Name:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter Fullname",name:"fullname",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Age:",l.a.createElement("input",{type:"number",min:"1",max:"9999999",name:"age",value:this.state.age,onChange:this.handleChange,required:!0}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Alias:",l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter Alias",name:"alias",onChange:this.handleChange,required:!0,pattern:"^(?=.{2,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$"})))),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Description"),l.a.createElement("textarea",{name:"description",value:this.state.characDescr,onChange:this.handleChange})),l.a.createElement("div",{className:"form-group-big"},l.a.createElement("legend",null,"Photo"),l.a.createElement("button",{type:"button",className:"btn btn-info"},l.a.createElement("label",{htmlFor:"createCharacImageInput"},"Choose a file")),l.a.createElement("div",null,l.a.createElement("img",{className:"formPreviewImage",src:this.state.imageUrl,alt:""})),l.a.createElement("input",{type:"file",name:"characPict",id:"createCharacImageInput",ref:this.fileInput,onChange:this.handleFileInput,className:"image-inputfile"}))),l.a.createElement("br",null),l.a.createElement("hr",null),l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Create new character"}))))}}]),t}(n.Component),B=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.title.image,t=this.props.title.name,a=this.props.title._id;return l.a.createElement("div",{className:"card border-dark mb-3"},l.a.createElement("div",{className:"card-img-wrapper"},l.a.createElement(p.b,{to:"/titles/"+a},l.a.createElement("img",{src:"".concat(e),className:"card-img-top",alt:"..."}))),l.a.createElement("div",{className:"card-body justify-content-between"},l.a.createElement("h5",{className:"card-title"},t),l.a.createElement(p.b,{to:"/titles/"+a},l.a.createElement("button",{className:"btn btn-secondary"},"Details"))))}}]),t}(n.Component),q=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).getPagesCount=function(e,t){var a=e%t===0?0:1;return Math.floor(e/t)+a},a.handlePageClick=function(e){var t="prev"===e?a.state.currentPageNo-1:a.state.currentPageNo+1;a.state.loading||a.setState({loading:!0,message:""},(function(){a.fetchSearchResults(t,a.state.query)}))},a.renderSearchResults=function(){var e=a.state,t=e.results,n=e.query;if(t&&Object.keys(t).length&&t.length){var r=t.map((function(e){return l.a.createElement(B,{title:e})}));return l.a.createElement("div",{className:"entities-wrapper",id:"characters-div"},r)}return l.a.createElement("div",{className:"alert alert-warning"},l.a.createElement("h2",null,"  No results for ",l.a.createElement("strong",null," ",n)))},a.handleOnInputChange=function(e){var t=e.target.value;t?a.setState({query:t,loading:!0,message:""},(function(){a.fetchSearchResults(1,t)})):(a.setState({query:t,results:{},totalResults:0,totalPages:0,currentPageNo:0,message:""}),a.fetchSearchResults(1,t))},a.fetchSearchResults=function(e,t){var n="/api/v1/titles?page=".concat(e=e||1).concat(t?"&search=".concat(t):"");a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(n,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){var n=t.data.resTitles.length?"":"There are no more search results. Please try a new search.";a.setState({currentPageNo:e,results:t.data.resTitles,pagesCount:t.data.pagesAmount,message:n,loading:!1})})).catch((function(e){(j.a.isCancel(e)||e)&&a.setState({loading:!1,message:"Failed to fetch results.Please check network"})}))};var n=f();return a.state={query:"",results:{},error:"",message:"",loading:!1,totalResults:0,pagesCount:0,currentPageNo:0,userRole:n.role,username:n.username},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSearchResults(1,"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.query,n=t.loading,r=t.currentPageNo,c=t.pagesCount,o=t.userRole,i=1<r,m=c>r;return 1!==o&&0!==o?l.a.createElement(s.a,{to:"/auth/login"}):l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("div",{className:"filter-box"},l.a.createElement("aside",{className:"filters"},l.a.createElement("p",null,"Some filters here")),l.a.createElement("aside",{className:"filters"},l.a.createElement("p",null,"And here"))),l.a.createElement("main",{className:"entities-main"},l.a.createElement("input",{type:"text",name:"search",value:a,id:"characSearch",className:"entitySearch",placeholder:"Search..",onChange:this.handleOnInputChange}),l.a.createElement("div",{className:"card-deck"},this.renderSearchResults()),l.a.createElement(A,{loading:n,showPrevLink:i,showNextLink:m,currPage:r,pagesCount:c,handlePrevClick:function(){return e.handlePageClick("prev")},handleNextClick:function(){return e.handlePageClick("next")}}),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin abilities:"),l.a.createElement(p.b,{to:"/newTitle",className:"btn btn-success"},"Create title"),l.a.createElement("button",{type:"button",className:"btn btn-info"},"Some admin Feature"),l.a.createElement("button",{type:"button",className:"btn btn-warning"},"Another admin Feature")):l.a.createElement(l.a.Fragment,null)))}}]),t}(n.Component),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).addCharClickHandler=function(e){e.preventDefault(),a.cancel=j.a.CancelToken.source();var t="/api/v1/admin/title/addCharac/".concat(a.props.character._id);fetch(t,{method:"post",cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){a.props.rerender()})).catch((function(e){}))},a.deleteCharClickHandler=function(e){e.preventDefault();var t="/api/v1/admin/title/addCharac/".concat(a.props.character._id);console.log(t),j.a.post(t,{headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){a.setState({status:e.status})})).catch((function(e){}))},a.state={charac:a.props.character},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement(p.b,{to:"/api/v1/characters/".concat(this.props.character._id)},this.props.character.name)),l.a.createElement("td",null,this.props.character.alias),l.a.createElement("td",null,this.props.character.titles[0]),l.a.createElement("td",null,this.state.charac.titles.includes(this.props.titleId)?l.a.createElement("form",{action:"/admin/title/deleteCharac/{{_id}}",method:"POST"},l.a.createElement("p",{style:{display:"none"}},"B "),l.a.createElement("input",{type:"submit",className:"btn btn-danger",value:"Delete char",onClick:this.deleteCharClickHandler})):l.a.createElement("form",{action:"/admin/title/addCharac/{{_id}}",method:"POST"},l.a.createElement("p",{style:{display:"none"}},"A "),l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Add char",onClick:this.addCharClickHandler}))))}}]),t}(n.Component),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).rerenderTable=function(){console.log("Rerendering table");j.a.get("/api/v1/charactersGetAll",{headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){a.setState({characters:e.data})})).catch((function(e){}))},a.renderSearchResults=function(){var e=a.state.characters;if(e&&Object.keys(e).length&&e.length){var t=e.map((function(e){return l.a.createElement(z,{titleId:a.props.titleId,character:e,rerender:a.rerenderTable})}));return l.a.createElement("tbody",null,t)}return l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"  No characs")))},a.state={characters:[],titleId:a.props.titleId},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;j.a.get("/api/v1/charactersGetAll",{headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){e.setState({characters:t.data})})).catch((function(e){}))}},{key:"render",value:function(){return l.a.createElement("div",{style:{width:"80%"}},l.a.createElement("button",{"data-toggle":"collapse","data-target":"#adminCollapse",className:"btn-success"},"Admining"),l.a.createElement("div",{id:"adminCollapse",className:"collapse show"},l.a.createElement("div",{className:"container",width:"100%"},l.a.createElement("table",{className:"table table-striped table-bordered",id:"dataTable",width:"100%",cellSpacing:"0"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Alias"),l.a.createElement("th",null,"Title Example"),l.a.createElement("th",null,"Action"))),this.renderSearchResults()))))}}]),t}(n.Component),$=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).fetchSearchResults=function(){var e="/api/v1/titles/".concat(a.state.titleId);a.cancel&&a.cancel.cancel(),a.cancel=j.a.CancelToken.source(),j.a.get(e,{cancelToken:a.cancel.token,headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){console.log(e),a.setState({title:e.data})})).catch((function(e){}))};var n=a.props.location.pathname.split("/"),l=n[n.length-1],r=f();return a.state={userRole:r.role,titleId:l},a.cancel="",a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSearchResults()}},{key:"render",value:function(){if(!this.state.title)return l.a.createElement("div",null,l.a.createElement("h1",null,"ERROR"));var e=this.state.title;return l.a.createElement("div",null,l.a.createElement(v,null),l.a.createElement("main",null,l.a.createElement("h2",null,"".concat(e.name)),l.a.createElement("div",{className:"entitiy-page-wrapper"},l.a.createElement("div",{className:"entity-page-image"},l.a.createElement("img",{src:e.image,alt:""})),l.a.createElement("div",{className:"entity-page-info"},l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"name:"),l.a.createElement("td",null,e.name)),l.a.createElement("tr",null,l.a.createElement("td",null,"Year of publishing:"),l.a.createElement("td",null,e.yearOfPublishing)),l.a.createElement("tr",null,l.a.createElement("td",null,"Was added:"),l.a.createElement("td",null,new Date(e.addedAt).toDateString()))))),l.a.createElement("div",{className:"table"},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Rating:"),l.a.createElement("td",null,e.reting)),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---")),l.a.createElement("tr",null,l.a.createElement("td",null,"Info:"),l.a.createElement("td",null,"---")))))),l.a.createElement("div",{className:"entity-page-footer"},l.a.createElement("p",null,"Some other text and abilities here without border and block")),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement("p",null,"Admin abilities:"),l.a.createElement("button",{type:"button",className:"btn btn-danger","data-toggle":"modal","data-target":"#exampleModalCenter"},"Delete title"),l.a.createElement("button",{type:"button",className:"btn btn-warning"},l.a.createElement(p.b,{to:"/updateTitle/".concat(e._id)},"Update Title"))):l.a.createElement(l.a.Fragment,null),1===this.state.userRole?l.a.createElement("div",{className:"adminButtons"},l.a.createElement(M,{titleId:e._id})):l.a.createElement(l.a.Fragment,null))),1===this.state.userRole?l.a.createElement(x,{entityName:"title ".concat(e.name),targetApiUrl:"/api/v1/titles/".concat(e._id),returnLink:"/titles"}):l.a.createElement(l.a.Fragment,null))}}]),t}(n.Component);c.a.render(l.a.createElement(p.a,null,l.a.createElement((function(e){return l.a.createElement("header",null,l.a.createElement("h1",null,"Anime Fanbase"))}),null),l.a.createElement((function(){return l.a.createElement("div",null,l.a.createElement(s.d,null,l.a.createElement(s.b,{exact:!0,path:"/",component:N}),l.a.createElement(s.b,{exact:!0,path:"/about",component:C}),l.a.createElement(s.b,{exact:!0,path:"/auth/login",component:w}),l.a.createElement(s.b,{exact:!0,path:"/auth/register",component:k}),l.a.createElement(s.b,{exact:!0,path:"/characters",component:F}),l.a.createElement(s.b,{exact:!0,path:"/characters/:id",component:L}),l.a.createElement(s.b,{exact:!0,path:"/newCharacter",component:_}),l.a.createElement(s.b,{exact:!0,path:"/updateCharacter/:id",component:D}),l.a.createElement(s.b,{exact:!0,path:"/titles",component:q}),l.a.createElement(s.b,{exact:!0,path:"/titles/:id",component:$}),l.a.createElement(s.b,{exact:!0,path:"/newTitle",component:H}),l.a.createElement(s.b,{exact:!0,path:"/users/:id",component:T}),l.a.createElement(s.b,{exact:!0,path:"/updateUser/:id",component:P}),l.a.createElement(s.b,{exact:!0,path:"/users",component:I}),l.a.createElement(s.b,{exact:!0,path:"/newTitle",component:F}),l.a.createElement(s.b,{exact:!0,path:"/titles/:id",component:L}),l.a.createElement(s.b,{exact:!0,path:"/titles",component:F}),l.a.createElement(s.b,{exact:!0,path:"/users",component:F})))}),null)),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.f5d3d310.chunk.js.map